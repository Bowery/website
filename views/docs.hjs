<!doctype html>
<meta charset="utf-8">
<title>Bowery</title>
<meta name="viewport" content="width=device-width, user-scalable=no">
<link href="/stylesheets/main.css" rel="stylesheet" />
<link href="/stylesheets/docs.css" rel="stylesheet" />
<link href="/stylesheets/mobile.css" rel="stylesheet" />
<link href="https://cloud.typography.com/7823052/643422/css/fonts.css" rel="stylesheet" />
<body>
  <header class="nav">
    <div class="content">
      <a href="/" class="logo">
        <div class="name">Bowery</div>
      </a>
      <ul class="links">
        <li class="selected">
          <a href="/docs">documentation</a>
        <li>
          <a href="/pricing">pricing</a>
        <li>
          <a href="/signup">sign up</a>
    </div>
  </header>
  <section class="buffer">
    <div class="content">
    <div class="side-nav-container">
      <ul class="side-nav">
        <li><a href="#getting-started">Getting Started</a></li>
        <li><a href="#core">Core</a></li>
        <li><a href="#database">Database</a></li>
        <li><a href="#search">Search</a></li>
        <li><a href="#cache">Cache</a></li>
        <li><a href="#queue">Queue</a></li>
        <li><a href="#email">Email</a></li>
        <li><a href="#static-assets">Static Assets</a></li>
        <li><a href="#production">Production</a></li>
        <li><a href="#overview">Philosophy</a></li>
      </ul>
      <a href="/signup" class="btn btn-primary">Sign Up</a>
    </div>
<div class="docs-content">
<h1>Introducing Bowery</h1>

<p class="tagline"><em>Welcome to the future of web development.</em></p>

<h2 id="getting-started">Getting Started</h2>

<h3>Installation</h3>

<p>Once you've <a href="http://bowery.io/signup">registered online</a>, you can install the command line interface using NPM:</p>

<pre><code>$ (sudo) npm install bowery -g
</code></pre>

<p>or you can install Bowery and its dependencies in one go.</p>

<pre><code>$ curl https://download.bowery.io/latest
</code></pre>

<p>This is particularly convenient for setting up and running Bowery on any computer.</p>

<h3>Connect</h3>

<p>Unlike most development environments, Bowery requires an internet connection. To get started, simply connect to Bowery.</p>

<pre><code>$ bowery connect
</code></pre>

<p>If you're connecting for the first time, Bowery will ask you to login and provide the key you received when registering. You can change this key later using the email and password you provided during registration.</p>

<h3>Git Workflow</h3>

<p>Bowery &ldquo;branches&rdquo; retain the same structure as git branches, but are also accessible online. When you connect to Bowery, you'll get a friendly reminder of the application and branch you're working on. It's highly recommended you don't work on the master branch. To change branches:</p>

<pre><code>$ bowery connect
&gt; Hey Steve, you're currently working on APP_NAME, developing on the MASTER branch.
$ bowery branch NEW_FEATURE
&gt; Opening new branch at https://NEW_FEATURE.APP_NAME.ACCOUNT_NAME.bowery.io
</code></pre>

<p>This URL is only accessible by you. If you're working with a team, they will have access if they are currently logged into Bowery.</p>

<p>When you're ready to merge to master:</p>

<pre><code>$ bowery merge BRANCH_NAME
&gt; Landing BRANCH_NAME onto MASTER
&gt; Opening production app at https://APP_NAME.ACCOUNT_NAME.bowery.io
</code></pre>

<h2 id="core">Core</h2>

<p>Instead of building a web framework from scratch, we've just written middleware for <a href="http://expressjs.com" target="_blank">express</a>. You add the middleware to your application with:</p>

<pre><code>app.use(require('bowery'))
</code></pre>

<p>In your handler callback, you'll have access to Bowery.</p>

<pre><code>app.get('/home', function (bowery, req, res, next) {
  // use bowery to handle the request
})
</code></pre>

<h2 id="database">Database</h2>

<p>BoweryDB is more of a data management application then a database. It analyzes access paterns to cache frequently-used data, and knows when you make updates in your code to make sure the cache is never stale. All that matters from the developers' point of view is the code they use to interact with it.</p>

<h3>Schemas</h3>

<p>You can add schemas in the <code>/schemas</code> directory:</p>

<pre><code>exports.User = {
 name: String,
 age: Number,
 friends: [User]
}
</code></pre>

<p>Values that are a single element array indicate a set of the type given as the only element. <code>friends: [User]</code> is an array of <code>User</code> objects. The supported types are the built-in javascript types &amp; schemas defined by the user in the schemas directory.</p>

<h3>Queries</h3>

<p>You can access the database driver in an express route handler.</p>

<pre><code>app.get('/user/:id', function (bowery, req, res, next) {
  bowery.db.user(req.params.id)
  .then(function (user) {
    res.render('user/show', {user: user})
  })
  .fail(handleError)
})
</code></pre>

<p>You can also insert or update an object by using:</p>

<pre><code>bowery.db.user(id, {
 name: 'Bob Bowery',
 age: 33
})
</code></pre>

<h2 id="search">Search</h2>

<p>BoweryDB is a simple key-value store, so for more complex queries we suggest using the search service.</p>

<p>You can search documents by calling:</p>

<pre><code>bowery.search({
  name: 'Bob B'
})
</code></pre>

<p>There's no reason to manually index documents. Bowery knows when you have search requests in your code and will manually index the relevant schemas. Bowery knows which schema you're intending to search based on what fields you pass it. In the above example, it will search any schema with a <code>name</code> attribute. If you want to scope a search to a specific schema, you can also use:</p>

<pre><code>// searches for users with a name similiar to Bob B
bowery.search('user', {name: 'Bob B'}) 
</code></pre>

<p>If you want to search in a domain other then a schema, you can manually index your own search domains.</p>

<pre><code>bowery.index('domainName', {username: 'Bob', dogsName: 'Rosco'})
</code></pre>

<h2 id="cache">Cache</h2>

<p>BoweryDB automatically moves db documents between a shared cache, a per machine cache, and an in-memory cache based on how the data is accessed. It can manage cache invalidation for models because data is only being changed inside of the Bowery application.</p>

<p>However, if you want to manually store data in the cache you can use:</p>

<pre><code>bowery.cache(key, value)
</code></pre>

<p>where the key is a string and the value can be a string or set of strings.</p>

<h2 id="queue">Queue</h2>

<p>Some tasks are best done in the background.</p>

<pre><code>bowery.queue(function (bowery) {
  // do something in the background
})
</code></pre>

<p>You can also run delayed jobs.</p>

<pre><code>bowery.queue(handler).delay(5000) // delay time is in ms
</code></pre>

<p>Cron jobs can be scheduled.</p>

<pre><code>bowery.queue(handler).every(3600).startAt(Date.now())
</code></pre>

<h2 id="email">Email</h2>

<p>Bowery has a built-in email service that manages email provider rate limiting and other annoyances such as inline styles. To send an email:</p>

<pre><code>bowery.email
      .to('foo@bar.com')
      .from('david@bowery.io')
      .cc(['concierge@bowery.io', 'help@bowery.io'])
      .bcc('records@bowery.io')
      .body('hello.hjs', 'email.css', {name: 'Mr. Foo Bar'})
</code></pre>

<p><code>to</code>, <code>from</code>, <code>cc</code>, and <code>bcc</code> can either take a string or an array of strings. The order of these four function calls in the chain doesn't matter, but the <code>body</code> needs to come last. The <code>body</code> method will render the given template with the data passed to it and then inline the styles in the specified stylesheet to generate the email body.</p>

<h2 id="static-assets">Static Assets</h2>

<p>Almost every web application has to handle and serve static assets. Bowery overrides the default express static middleware so that whatever folder you mount with will be served from a special static file server and put behind a CDN in production:</p>

<pre><code>app.use(express.static('path/to/folder'))
</code></pre>

<p>Stylesheets and scripts will also be gzipped &amp; minified in production.</p>

<h3>Image Uploading</h3>

<p>Handling images is normally a terrible experience. Bowery makes uploading and serving images a breeze.</p>

<pre><code>app.post('/upload', function (bowery, req, res) {
  bowery.cdn.upload('imageName', req.files.logo)
  .then(function () {
    res.send("upload successful")
  })
  .fail(function () {
    res.send("upload failed")
  })
})
</code></pre>

<h3>Rendering</h3>

<p>In your templates you will have access to a <code>cdn</code> variable. If you're using Hogan templates, rendering static assets might look something like:</p>

<pre><code>&lt;img src="{{ cdn['path/to/image.jpg'] }}"&gt;
</code></pre>

<p>The rendered html will look something like:</p>

<pre><code>&lt;img src="//cdn.bowery.io/appName/path/to/image.jpg"&gt;
</code></pre>

<h3>Resizing</h3>

<p>If you would like to render an image at a specific size, you can just add an <code>s</code> parameter to the end of the path. For a 50px by 50px image:</p>

<pre><code>&lt;img src="{{ images['imageName'] }}?s=50x50"&gt;
</code></pre>

<h2 id="production">Production</h2>

<h3>Use a Custom Domain</h3>

<p>Configure your DNS to point to <code>APP_NAME.bowery.io</code> and add the domain to your application in the terminal.</p>

<pre><code>$ bowery domains:add www.foo.com
</code></pre>

<p>You can also remove the domain from your application.</p>

<pre><code>$ bowery domains:remove www.foo.com
</code></pre>

<h2 id="philosophy">Philosophy</h2>

<p>Web development is terribleâ€”it's filled with convoluted abstrations that have little to do with building a product. Today we care about users, but most of our time is spent worrying about server and database management.</p>

<p>When writing a Bowery application, you just write code and the rest takes care of itselfâ€”there isn't even a local development environment. Common services that developers set up for each application (database, caching, email, search, CDN, etc.) are already built into Bowery. Implementation details and performance optimizations are made behind the scenes so that you can focus all of your energy on the product.</p>

      </div>
    </div>
  </section>
  <footer class="footer">
    <div class="content">
      <p>&copy;2013 Bowery Software, LLC. All rights reserved.</p>
      <a href="mailto:concierge@bowerygroup.com">Contact</a>
    </div>
  </footer>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-44042663-1', 'bowery.io');
    ga('send', 'pageview');

  </script>
